
# 2f-tomwhartung.md

Totally changing everything about tomwhartung.com before moving it to the new server.

# Technical Updates

Switch tomwhartung.com from using WP to using Django and MDB.

- [x] Get single-page, bare minimum, hello-world type site going
- [x] Worry about coding after we do the server shuffle

# TomWHartung.com on Django

## Process Overview

Details for accomplishing each of these tasks appear below.

- [x] 1. Establish the Site
- [x] 2. Ye Olde Hello, World
- [x] 3. Tutorial Part 2: Settings Cleanup
- [x] 4. Material Design Bootstrap
- [x] 5. Implement Essential View Templates
- [ ] 6. Minimal Content

## References

- Start project
  - https://docs.djangoproject.com/en/3.0/intro/tutorial01/
- Material Design Bootstrap (MDB)
  - Using the jQuery version
  - https://mdbootstrap.com/docs/jquery/getting-started/download/

## Process Details

For an overview of these steps, see the section "Process Overview" above.

### 1. Establish the Site

Start the project, replace the settings.py file with a link, and copy in some basic files from `artsyvisions.com`:

```
gotwt                   # /var/www/tomwhartung.com/htdocs/tomwhartung.com
django-admin startproject Site
cd Site
python manage.py runserver
```

Access [http://127.0.0.1:8000/](http://127.0.0.1:8000/) in the browser to confirm the installation worked ok,
then kill the server with Ctrl-C.

#### Secure the `settings.py` File

Replace the settings.py file with a link, copy in some basic files from `artsyvisions.com` and commit what we have so far:

```
gotwt                                            # /var/www/tomwhartung.com/htdocs/tomwhartung.com
mkdir gitignored/Site/Site
mkdir -p gitignored/Site/Site
mv Site/Site/settings.py  gitignored/Site/Site
cd Site/Site/
ln -s ../../gitignored/Site/Site/settings.py .
cat settings.py                                 # Make sure we can still "see" it here
cd -
```

#### Copy Some Standard Files From the ArtsyVisions.com Site

Having a few django sites already set up, I have a preferred way of doing things.

Copy these files from `artsyvisions.com` because it is one of the newest.

```
cp /var/www/artsyvisions.com/htdocs/artsyvisions.com/.gitignore .
mkdir Site/bin
cp /var/www/artsyvisions.com/htdocs/artsyvisions.com/Site/bin/* Site/bin/
rm  Site/bin/artsyvisions_env.sh
cd Site/bin/
cat collectstatic.sh
vi run.sh                                       # Change port number to 8003
cd -
ga .gitignore
gc 'Adding .gitignore file from artsyvisions.com .'
ga Site/bin/collectstatic.sh
gc 'Adding Site/bin/collectstatic.sh file from artsyvisions.com .'
ga Site/bin/run.sh
gc 'Adding Site/bin/run.sh file from artsyvisions.com .'
l Site/
ga Site/
gc 'Adding all the Site/* files generated by startproject .'
```

### 2. Ye Olde Hello, World

Continuing with the first step of the tutorial at:

- https://docs.djangoproject.com/en/3.0/intro/tutorial01/

However, instead of a `polls` app, we create a `content` app.

```
gotws                                  # /var/www/tomwhartung.com/htdocs/tomwhartung.com/Site
python manage.py startapp content
```

After creating the project, edit the files `content/views.py`, `content/urls.py` and `Site/urls.py` as described in the tutorial.

```
vi content/views.py
vi content/urls.py
vi Site/urls.py
cd bin
./run.sh
```

Accessing the server at [http://127.0.0.1:8003/](http://127.0.0.1:8003/) displays the Hello World message from the view.

### 3. Tutorial Part 2: Settings Cleanup

Part 2 is all about the Database and models, which we will not be using now, if ever.

In my case, the goal of this step is to clean up `settings.py`.

#### References

These references apply to this step only.

- (1) https://docs.djangoproject.com/en/3.0/intro/tutorial02/
- (2) https://docs.djangoproject.com/en/3.0/howto/deployment/checklist/
- (3) https://docs.djangoproject.com/en/3.0/ref/settings/#std:setting-SECRET_KEY
- (4) https://docs.djangoproject.com/en/3.0/ref/settings/#std:setting-DEBUG
- (5) https://docs.djangoproject.com/en/3.0/ref/settings/#std:setting-ALLOWED_HOSTS
- (6) https://docs.djangoproject.com/en/3.0/ref/settings/#std:setting-INSTALLED_APPS
- (7) https://docs.djangoproject.com/en/3.0/ref/settings/#std:setting-DATABASES
- (8) https://docs.djangoproject.com/en/3.0/ref/settings/#std:setting-STATIC_ROOT

#### Key Settings

Check these key settings and update them as applicable.

- SECRET_KEY
  - Per (3) "django-admin startproject automatically adds a randomly-generated SECRET_KEY to each new project"
- DEBUG
  - Use `RUNNING_LOCALLY` variable, as in the artsyvisions.com file
- ALLOWED_HOSTS
  - Set in a fashion similar to that used in the artsyvisions.com file
- INSTALLED_APPS
  - Add `content`
- DATABASES
  - Per (7) "The DATABASES setting must configure a default database"
  - So far, I have not experienced problems running without a DB
  - I believe this is for the admin feature, which I will not be using right away
  - **For now, just comment out all lines defining the `DATABASES` parameter**
- STATIC_ROOT
  - We want to make this match what we are using on artsyvisions.com, so copy the code and comments for that setting
- STATIC_URL
  - We want to make this match what we are using on artsyvisions.com, so copy the code and comments for that setting

### 4. Material Design Bootstrap

#### References

These references apply to this step only.

- https://mdbootstrap.com/
- https://mdbootstrap.com/education/bootstrap/quick-start/

#### Add `favicon.ico` File

This should work ok, we'll see.

```
gotws                                  # /var/www/tomwhartung.com/htdocs/tomwhartung.com/Site
l
mkdir -p content/static/content
cp /var/www/artsyvisions.com/htdocs/artsyvisions.com/Site/content/static/content/favicon.ico  content/static/content
ga content/static/content/favicon.ico
gc 'Adding the content/static/content/favicon.ico file.'
```

#### Add Essential View Templates

Add templates for the base, home, and 404 views.

To make things easy, we copy them from seeourminds.com , which also uses MDB.

```
gotwsc                                # /var/www/tomwhartung.com/htdocs/tomwhartung.com/Site/content
mkdir -p templates/content
l /var/www/seeourminds.com/htdocs/seeourminds.com/Site/content/templates/content
cp /var/www/seeourminds.com/htdocs/seeourminds.com/Site/content/templates/content/404.html .
cp /var/www/seeourminds.com/htdocs/seeourminds.com/Site/content/templates/content/base.html .
cp /var/www/seeourminds.com/htdocs/seeourminds.com/Site/content/templates/content/home.html .
ga *.html
gc 'Adding the 404.html , base.html , and home.html templates.  These initial versions were copied from seeourminds.com .'
```

Now edit those files, e.g., in kate, making them suitable for tomwhartung.com rather than seeourminds.com .

- Change all `seeourminds.com` to `tomwhartung.com`
- Remove navigation, i.e., `block navbar` from `base.html`
- Remove almost all content, leaving just a statement or two stating the site is under construction.
- Remove much of the footer, leaving just a copyright statement and maybe a link or two.

#### Convert View Templates to Use MDB

Download the latest version (4) of MDB + JQuery from:

- https://mdbootstrap.com/

Save the downloaded file for possible future reference and unzip it someplace "safe," e.g., `/var/www/tomwhartung.com/unzip`.

```
gotw                        # /var/www/tomwhartung.com
mkdir downloads
mkdir unzip
cd  downloads
lst ~/Downloads/
mv  ~/Downloads/MDB-Free_4.19.0.zip .
cp MDB-Free_4.19.0.zip ../unzip
cd ../unzip
unzip MDB-Free_4.19.0.zip
rm MDB-Free_4.19.0.zip
```

Now access [file:///var/www/tomwhartung.com/unzip/index.html](file:///var/www/tomwhartung.com/unzip/index.html) in a browser window.

- 1. Review the tutorial and the files in the unpack area.
- 2. Adjust the templates - especially `base.html` - as necessary.
- 3. Copy files from the unzip area into the appropriate subdirectory in the static files tree

```
gotwscs                               # /var/www/tomwhartung.com/htdocs/tomwhartung.com/Site/content/static/content
l
l /var/www/tomwhartung.com/unzip/
mkdir css
cp -r /var/www/tomwhartung.com/unzip/css/* css/
mkdir js
cp -r /var/www/tomwhartung.com/unzip/js/* js/
l
l /var/www/tomwhartung.com/unzip/
cp  /var/www/tomwhartung.com/unzip/*.pdf  /var/www/tomwhartung.com/unzip/README.txt  .
l
l /var/www/tomwhartung.com/unzip/
cp -r /var/www/tomwhartung.com/unzip/exclusive-templates/  /var/www/tomwhartung.com/unzip/img/ /var/www/tomwhartung.com/unzip/scss/  /var/www/tomwhartung.com/unzip/src .
l
gs .
ga *
gc 'Adding the MDB static files into Site/content/static/content .'
touch css/tomwhartung.css
touch js/tomwhartung.js
gs
ga css/tomwhartung.css
gc 'Adding empty placeholder css file css/tomwhartung.css .'
ga js/tomwhartung.js
gc 'Adding empty placeholder js file css/tomwhartung.js .'
```

The sample `index.html` file, and hence my `base.html` template, use just the `css/*.css` and `js/*.js` files,
so I copied them first.

**After some consideration, I decided to copy almost all of the other files in the downloaded zip file into this area as well.**

### 5. Implement Essential View Templates

Update `urls.py` and `views.py` to use the new templates.

#### References

These references apply to this step only.

- https://docs.djangoproject.com/en/3.0/intro/tutorial03/
- https://docs.djangoproject.com/en/3.0/topics/http/urls/

#### The `base.html` and `home.html` Templates

Following the third part of the tutorial, edit the code to use the `base.html` and `home.html` templates.

#### The `404.html` template

Update the code to use the `404.html` template.

Update `urls.py` to use the `re_path` function to set up a regex that catches everything but '' and 'home'
and update `views.py` to display the `404.html` template when that happens.

#### Fix for the Css Map Issue

The firefox developer tools says it can't find the map file for `bootstrap.min.css`.

##### References:

- https://developer.mozilla.org/en-US/docs/Tools/Debugger/Source_map_errors
- https://stackoverflow.com/questions/21773376/bootstrap-trying-to-load-map-file-how-to-disable-it-do-i-need-to-do-it

Updated the special comment at the end of `Site/content/static/content/css/bootstrap.css` (rather than delete it)
and updated `base.html` to use the `bootstrap.css` file instead of `bootstrap.min.css`.

Now the page loads without errors or warnings, yay!


-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


### 6. Minimal Content



# Content Updates

Update site to contain:

- List of my spiritual portrait books
- List of my spiritual portrait sites
- List of social networking sites where I post spiritual portraits
- Call for help with sales
  - Maybe dedicate a page to this: I am no salesman, can offer commision only, etc.


