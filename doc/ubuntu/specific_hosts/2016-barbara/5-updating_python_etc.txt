
 Updating Python Etc.
======================
We are playing around with some python on bette, and want to have
our process down for when it comes time to upgrade the installations
on jane, barbara, and ava.

Running these commands on barbara
---------------------------------
NOTE:
It appears we need version 0.12 of flask for the test_insert_functions function
in db_access.py to work.
So we need to upgrade these packages on barbara and ava when deploying!

NOTE:
We need to be very cognizant of what versions of python, flask, and django we are
running on the servers!

NOTE:
We may want to consider using virtual environments on the servers at some point.
However, I would like to avoid doing that, in the interest of keeping it simple,
which means keeping installed software and versions to the bare minimum.

Upgrade Python
--------------
[ ] Upgrade python 3.5 to 3.6
    References:
      http://askubuntu.com/questions/865554/how-do-i-install-python-3-6-using-apt-get
      http://www.ubuntumaniac.com/2016/12/python-360-is-released-install-on.html
    As root:
      add-apt-repository ppa:jonathonf/python-3.6
      apt-get update
      apt-get install python3.6

Upgrade Flask
-------------
[ ] Upgrade flask to version 0.12
    (This is a little trick I learned in the real python class.)
    As root:
      pip3 uninstall flask
      pip3 install flask==0.12

Install sendmail for groja.com
------------------------------
We need sendmail on all servers so we can use python to send emails:
Note that this fixes the following error:
    ConnectionRefusedError: [Errno 111] Connection refused
[ ] Install sendmail
    As root:
      apt-get update
      apt-get upgrade -y
      apt-get -y install sendmail
NOTE: Got the following warning when installing sendmail on barbara
      (and all the others too, btw):
   "Warning: 3 database(s) sources
      were not found, (but were created)
      please investigate."
Tried googling this but did not see anything about how to fix it.

Install PostgreSQL Database for Storing SeeOurMinds.com Quiz Results
--------------------------------------------------------------------
References:
* https://www.digitalocean.com/community/tutorials/how-to-use-postgresql-with-your-django-application-on-ubuntu-16-04
* https://djangogirls.gitbooks.io/django-girls-tutorial-extensions/content/optional_postgresql_installation/
* https://wiki.postgresql.org/wiki/Detailed_installation_guides#General_Linux

[ ] Install postgres in ubuntu:
    As root:
      apt-get update
      dpkg-query --list python3-pip
      dpkg-query --list python3-dev
      dpkg-query --list libpq-dev
      apt-get install libpq-dev postgresql postgresql-contrib -y
[ ] Enter the postgres shell:
    As root:
      su - postgres
      psql        # prompt changes
[ ] Use the postgres shell to create the user and database:
    In the postgres shell:
      CREATE USER som_user WITH PASSWORD 'abc123';
      CREATE DATABASE som_db owner som_user;
      ALTER ROLE som_user SET client_encoding TO 'utf8';
      ALTER ROLE som_user SET default_transaction_isolation TO 'read committed';
      ALTER ROLE som_user SET timezone TO 'MST';
      \q      ## log out
[ ] Install python postgres "psycopg2" package globally:
    As root:
       pip3 install psycopg2
[ ] Verify installation of python postgres "psycopg2" package:
    As tomh:
      python3 -c "import psycopg2"    ## no errors means it worked
      python3
      >>> import psycopg2
      >>> psycopg2.__version__        ## '2.7.1 (dt dec pq3 ext lo64)'

Install PhpPgAdmin
------------------
** DO NOT DO THIS ON PRODUCTION HOSTS!!!  DUH!!! **

Updating the Django Settings File:
----------------------------------
References:
* https://www.digitalocean.com/community/tutorials/how-to-use-postgresql-with-your-django-application-on-ubuntu-16-04
* https://djangogirls.gitbooks.io/django-girls-tutorial-extensions/content/optional_postgresql_installation/

[ ] Summary of commands to run to enter the postgres shell:
    As root:
      su - postgres
      psql
[ ] Summary of test db credentials:
    User/pwd: som_user/abc123
    DB: som_db
[ ] Update the settings.py file to use these values:
    Note: the two references use slightly different engins
        'ENGINE': 'django.db.backends.postgresql_psycopg2',  ## digital ocean
        'ENGINE': 'django.db.backends.postgresql',           ## djangogirls
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.postgresql_psycopg2',
            'NAME': 'django_test',
            'USER': 'seeourminds',
            'PASSWORD': 'abc123',
            'HOST': 'localhost',
            'PORT': '',
        }
    }
