#!/bin/bash
#
# dbBackupOne: backup specified db on localhost
# ------------------------------------------
#
function badSyntax
{
   echo 'Syntax: dbBackupOne sitename dbname [ password ]'
   echo "  Saves a copy of the specified site's in ~tomh/backup/db"
}

if [ $# -lt 2 ]; then
   badSyntax
   exit 1
fi

sitename=$1
dbname=$2
password=$3

echo "sitename = \"$sitename\""
echo "dbname = \"$dbname\""
echo "password = \"$password\""

umask 077
date=$(date +'%Y_%m_%d')
hostname=$(hostname)
backup_file_name="${sitename}-${date}-${hostname}.sql.gz"
backup_dir=~tomh/backup/db

cd $backup_dir
echo "Backing up $sitename site DB to ${backup_dir}/${backup_file_name} ..."
mysqldump --quick --opt -u root -p${password} $dbname | gzip > $backup_file_name
echo "... done."
echo "backup_file_name = $backup_file_name"
echo
cd $backup_dir

if [ $hostname == 'bette' ]; then
## toJane $backup_file_name
   toLauren $backup_file_name
elif [ $hostname == 'jane' ]; then
   toBette $backup_file_name
   toLauren $backup_file_name
elif [ $hostname == 'lauren' ]; then
## toBette $backup_file_name
   echo "WARNING: not saving any extra copies of databases on lauren!"
fi

echo

